\chapter{Modelos de Redes Complexas}
\label{chapter:networks}

Grafos são estruturas de dados que codificam relações, e estão presentes em uma
grande variedade de cenários.
Estes são compostos por nós que representam elementos, quaisquer que sejam, e
arestas que são as relações entre os elementos na rede.
Se tratando de redes sociais grafos são especialmente importantes dado que
a relação entre os usuários é a principal componente desses serviços.
Ao longo das ultimas décadas o estudo de modelos aplicados aos grafos, foi se
tornando cada vez mais relevante.
Esses modelos visam capturar diversas características possíveis das redes como a
evolução do grafo no tempo, a propagação de epidemias dentro da rede,
recomendação de arestas, a predição de classes de um dado nó ou aresta, entre outros.

Neste capitulo serão estudados modelos de representações de nós.
Assim como no caso de documentos textuais, estes modelos, em geral, visam
codificar a informação de um nó em um vetor de baixa dimensionalidade,
capturando tanto seus atributos individuais quanto os decorrentes da estrutura
de conexões do mesmo.
Este objetivo se adequa ao presente trabalho pois permite que seja treinado um
classificador único que utilize tanto a informação capturada pela linguagem quanto
da a provinda da rede.

% FIGURA: com subfiguras representado cada uma das tarefas citadas
% - classificacao de nós: grafos com nós em 2 cores
% - classificação de grafos: multiplos grafos, divididos em 2 cores...

% pegar exemplo de figura de artigo de classificacao de nos
% de 2 grafos egocentricos de classes distintas

% grande referencia em graph embeddings
% A Comprehensive Survey of Graph Embedding: Problems, Techniques and Applications
% Graph Embedding Techniques, Applications, and Performance: A Survey

\section{Modelos Baseados em Fatoração Matricial}

A primeira modalidade de técnicas de representação de nós a ser desenvolvida foi
a por fatoração matricial.
Essa consiste em utilizar o resultado da fatoração de uma das matrizes
características da rede como representação dos nós, dentro os exemplos de
matrizes dos grafos temos: a matriz de adjacência, a matriz Laplaciana, a matriz
de centralidade de Katz, entre outras~\cite{goyal18}.
Nos casos que a matriz é positiva e semi-definida, como a matriz Laplaciana, é
possível aplicar a decomposição em autovalores, nos outros casos, em geral, são
utilizados métodos iterativos visando minimizar uma função custo.

\subsubsection{Locally Linear Embedding (LLE)}

\citet{roweis00} desenvolveram esse algoritmo que tem como premissa que um nó é
uma combinação linear de seus vizinhos.
Portanto tendo a matriz de adjacencia $W_{ij}$ e o vetor de representação de um
nó como $Y_i$, definimos o mesmo como:

\begin{equation}
    Y_i \approx \sum_j{W_{ij}Y_j}
\end{equation}

A função custo a ser minimizada para atingir é a que minimiza o erro de
representação do somatório de todos os nós, sendo assim a função custo $\phi(Y)$
é dada por:

\begin{equation}
    \phi(Y) = \sum_i{|Y_i - \sum_j{W_{ij}Y_j}|^2}
\end{equation}

Sendo necessário respeitar a restrição $\frac{1}{N}Y^TY = 1$ para XXXX.
Esta técnica obtém uma representação de nós que preserva as distância de
primeira ordem da rede, ou seja, vizinhos diretos no grafo original vão obter
representações próximas.

\subsubsection{Automapas Laplacianos}

Esta técnica desenvolvida por \citet{belkin02} também tem como objetivo obter
representações próximas entre vizinhos, desta vez inspirada na equação de fluxo
de calor, usando a matriz laplaciana do grafo.
Sua função custo é dada pela equação~\ref{eq:laplacian_eigenmaps} na qual $L$ é
a laplaciana do grafo.

\begin{equation} \label{eq:laplacian_eigenmaps}
\begin{aligned}
    \phi(Y) &= \frac{1}{2} \sum_{ij}{|Y_i - Y_j|^2 W_{ij}} \\
            &= tr(Y^TLY)
\end{aligned}
\end{equation}

\subsubsection{HOPE}

Os algoritmos apresentados anteriormente são efetivos para manter a distância
entre vizinhos de um grafo não-direcionado.
Entretanto, grafos direcionados reais que em grande parte das vezes tem sua
distribuição de grau seguindo uma lei de potência, como é o caso dos grafos
formados em redes sociais, as propriedades de um par de nós não são simétricas.
Para obter representações que respeitem essa assimetria \citet{ou16}
desenvolveram o algoritmo \textit{High-Order Proximity preserved Embedding}
(HOPE).
A chave deste algoritmo é utilizar métricas de proximidade de ordem superior em
sua função custo, preservando assim as propriedades da assimetria.
Qualquer medida de proximidade pode ser aplicada neste algoritmo, \citet{ou16}
em seu estudo testaram medidas como a proximidade de Katz e Pagerank
personalisado, mostrando que em varios casos essas medidas possuem aproximações
que diminuem o custo computacional da otimização.

HOPE representa cada vértice em 2 vetores, um de entrada e um de saída, o qual
denominaremos respectivamente $Y^s$ e $Y^t$.
A função custo é dada pela equação~\ref{eq:hope} na qual $S$ representa a matriz
de proximidade entre os nós dada por qualquer uma das medidas escolhidas.

\begin{equation} \label{eq:hope}
    \phi = \vert\vert S - Y^s {Y^t}^{T} \vert\vert^2_F
\end{equation}

\section{Modelos Baseados em Passeios Aleatórios}

\subsubsection{DeepWalk}

\subsubsection{node2vec}

% \section{Modelos de Deep Learning}
\subsubsection{GCN}
